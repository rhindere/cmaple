
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Introduction to pyexpander &#8212; pyexpander 1.8.4 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.8.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyexpander reference" href="reference-expander.html" />
    <link rel="prev" title="Welcome to pyexpander’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="reference-expander.html" title="pyexpander reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to pyexpander’s documentation!"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyexpander 1.8.4 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction-to-pyexpander">
<h1>Introduction to pyexpander<a class="headerlink" href="#introduction-to-pyexpander" title="Permalink to this headline">¶</a></h1>
<div class="section" id="macro-substitution">
<h2>Macro substitution<a class="headerlink" href="#macro-substitution" title="Permalink to this headline">¶</a></h2>
<p>Note: The examples below use “expander3.py”, the python 3 implementation of
pyexpander. You have to call “expander.py” if you installed the python 2
implementation of pyexpander.</p>
<p>For some projects there is the need to replace macros in a text file with
values defined in other files or the command line. There are already other
macro replacement tools that can do this but if you want to calculations or
string operations and insert the results of this into your file, the list of
possible tools becomes much shorter.</p>
<p>Pyexpander combines the python programming language with a simple macro
replacement scheme in order to give the user both, ease of use and the
power of a full featured scripting language.</p>
<p>Even without being familiar with python you can use pyexpander to perform
calculations or string operations and use the results in your macro
replacements.</p>
<p>Here is a very simple example, this is the content of file “letter.txt”:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Dear $(salutation) $(surname),

this is a simple pyexpander example.
</pre></div>
</div>
<p>Applying this command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">expander3</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="nb">eval</span> <span class="s1">&#39;salutation=&quot;Mr&quot;;surname=&quot;Smith&quot;&#39;</span> <span class="o">-</span><span class="n">f</span> <span class="n">letter</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>gives this result:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Dear</span> <span class="n">Mr</span> <span class="n">Smith</span><span class="p">,</span>

<span class="n">this</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">simple</span> <span class="n">pyexpander</span> <span class="n">example</span><span class="o">.</span>
</pre></div>
</div>
<p>Here is more advanced example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$py(start=0; end=5)\
 x |  x**2
---|------
$for(x in range(start,end+1))\
$(&quot;%2d | %3d&quot; % (x,x*x))
$endfor\
</pre></div>
</div>
<p>Applying expander.py to a file with the content shown above gives the following
result:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="n">x</span> <span class="o">|</span>  <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="o">---|------</span>
 <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>
 <span class="mi">1</span> <span class="o">|</span>   <span class="mi">1</span>
 <span class="mi">2</span> <span class="o">|</span>   <span class="mi">4</span>
 <span class="mi">3</span> <span class="o">|</span>   <span class="mi">9</span>
 <span class="mi">4</span> <span class="o">|</span>  <span class="mi">16</span>
 <span class="mi">5</span> <span class="o">|</span>  <span class="mi">25</span>
</pre></div>
</div>
<p>And here we show how pyexpander compares with the well known m4 macro
processor. We have taken the
<a class="reference external" href="http://en.wikipedia.org/wiki/M4_(computer_language)">m4</a> example with small
modifications from Wikipedia:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>divert(-1)
# This starts the count at ONE as the incr is a preincrement.
define(`H2_COUNT&#39;, 0)
# The H2_COUNT macro is redefined every time the H2 macro is used.
define(`H2&#39;,
        `define(`H2_COUNT&#39;, incr(H2_COUNT))&lt;h2&gt;H2_COUNT. $1&lt;/h2&gt;&#39;)
divert(0)dnl Diversion to 0 means back to normal. dnl macro removes this line.
H2(First Section)
H2(Second Section)
H2(Conclusion)
</pre></div>
</div>
<p>Here is the same example formulated in pyexpander:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$py(
# This starts the count at ONE as the incr is a preincrement.
H2_COUNT=0
# H2_COUNT is incremented each time H2 is called.
def H2(st):
    global H2_COUNT
    H2_COUNT+=1
    return &quot;&lt;h2&gt;%d. %s&lt;/h2&gt;&quot; % (H2_COUNT,st)
)\
$# the following makes H2 callable without another pair of enclosing brackets:
$extend(H2)\
$H2(&quot;First Section&quot;)
$H2(&quot;Second Section&quot;)
$H2(&quot;Conclusion&quot;)
</pre></div>
</div>
<p>Both produce this output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="mf">1.</span> <span class="n">First</span> <span class="n">Section</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="mf">2.</span> <span class="n">Second</span> <span class="n">Section</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="mf">3.</span> <span class="n">Conclusion</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The advantages of pyexpander are:</p>
<ul class="simple">
<li>simple syntax definition, all expander commands start with a dollar (“$”)
sign followed by word characters, parameters or python code enclosed in
brackets or both.</li>
<li>the full power of the python programming language can be used, all operators,
functions and modules.</li>
<li><em>any</em> python expression can be used to insert text.</li>
<li>There is also a python library, pyexpander.py, which you can use to develop
other macro tools based on pyexpander.</li>
</ul>
<p>If you are not familiar with the python programming language, you should have
a look at <a class="reference internal" href="python3.html"><span class="doc">python 3 introduction for pyexpander</span></a>.</p>
<p>If you intend to use the python 2 version of pyexpander, you should look at
<a class="reference internal" href="python2.html"><span class="doc">python 2 introduction for pyexpander</span></a>.</p>
<p>For a detailed description of the pyexpander language see
<a class="reference internal" href="reference-expander.html"><span class="doc">reference</span></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction to pyexpander</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#macro-substitution">Macro substitution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference-expander.html">pyexpander reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="epics-support.html">EPICS support in pyexpander</a></li>
<li class="toctree-l1"><a class="reference internal" href="python2.html">pyexpander for users not familiar with python version 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="python3.html">pyexpander for users not familiar with python version 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="expander-options.html">expander.py and expander3.py command line options</a></li>
<li class="toctree-l1"><a class="reference internal" href="msi2pyexpander-options.html">msi2pyexpander.py and msi2pyexpander3.py command line options</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyexpander-install.html">Installing pyexpander</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyexpander-install-by-setup.html">Installing pyexpander by running setup.py</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to pyexpander’s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="reference-expander.html"
                        title="next chapter">pyexpander reference</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/introduction.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="reference-expander.html" title="pyexpander reference"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to pyexpander’s documentation!"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyexpander 1.8.4 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Helmholtz-Zentrum Berlin GmbH.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>